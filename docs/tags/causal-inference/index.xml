<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Causal Inference on Bingz Learning Blog</title>
    <link>/tags/causal-inference/</link>
    <description>Bingz Learning Blog (Causal Inference)</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <managingEditor>bingwang8878@gamil.com (Bing Wang)</managingEditor>
    <webMaster>bingwang8878@gamil.com (Bing Wang)</webMaster>
    <lastBuildDate>Tue, 28 May 2024 16:19:16 -0700</lastBuildDate>
    
    <atom:link href="/tags/causal-inference/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Causality</title>
      <link>/posts/causality/</link>
      <pubDate>Tue, 28 May 2024 16:19:16 -0700</pubDate>
      <author>bingwang8878@gamil.com (Bing Wang)</author>
      <guid>/posts/causality/</guid>
      <description>&lt;p&gt;This is a test post for the causality section.&lt;/p&gt;
&lt;h2 id=&#34;what-is-causality&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#what-is-causality&#34;&gt;
    &lt;/a&gt;
    What Is Causality?
&lt;/div&gt;
&lt;/h2&gt;
&lt;p&gt;Different from common ML tasks that focus on summarizing the patterns in the data, expecting to make predictions on
similar unseen data. Causality, on the other hand, is about understanding the underlying mechanisms that drive the data.
It is about to predict how the people/agent/system would react if it were intervened in a certain way. Think about the
example of having two parallel universes with different light, temperature, and humidity conditions. What would happen
to a plant if it were moved from one universe to another? This is a causal question.&lt;/p&gt;
&lt;h3 id=&#34;causal-formulation&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#causal-formulation&#34;&gt;
    &lt;/a&gt;
    Causal Formulation
&lt;/div&gt;
&lt;/h3&gt;
&lt;p&gt;To understand how the outcome would change in different conditions, we need to define the following notations to
describe the causal relations.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$Y_i$: the outcome of interest for individual $i$. For example, the health status of a patient.&lt;/li&gt;
&lt;li&gt;$A_i$: an indicator of whether the individual $i$ received the treatment. For example, a new drug.&lt;/li&gt;
&lt;li&gt;$X_i$: a set of covariates that may affect both the treatment assignment and the outcome. For example, health status,
age, gender etc&lt;/li&gt;
&lt;li&gt;$U_i$: unobserved factors that may affect both the treatment assignment and the outcome. For example, genetic factors.&lt;/li&gt;
&lt;li&gt;$Y_i^{a}$: the potential outcome of individual $i$ if he/she received the treatment $A = a, a \in \{0, 1\}$. For
example, the health status of a patient if he/she received the new drug ($a=1$).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In practice, the data $(Y_i, A_i, X_i)$ is usually drawn i.i.d from a population and they are formulated into a causal
graph as shown below.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://bingzw.github.io/causality/causal_model_diagram.png&#34; alt=&#34;causal_model_diagram&#34;&gt;
The mechanism of the causal graph is often reasoning by structural causal models (SCM). It models the underlying data
generation process with an ordered sequence of functions that map the parent nodes to the child nodes. For example, the
SCMs of the above causal graph can be written as:
$P(Y, A, X) = P(Y | A, X) P(X | A) P(A)$. This equation describes the probabilistic dependencies between the observed
variables. Now the question is how do we define the effect of the new drug $A$ on health outcome $Y$?&lt;/p&gt;
&lt;h3 id=&#34;average-treatment-effect&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#average-treatment-effect&#34;&gt;
    &lt;/a&gt;
    Average Treatment Effect
&lt;/div&gt;
&lt;/h3&gt;
&lt;p&gt;Let&amp;rsquo;s continue with the above drug trail context and notations. Consider a simple case with a binary treatment $A$
(1: treated, 0: untreated) and a binary outcome $Y$ (1: recovered, 0: not recovered).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$Y^{a=1}$ (Y under the treatment
a = 1) be the outcome variable that would have been observed if the patient had received the treatment.&lt;/li&gt;
&lt;li&gt;$Y^{a=0}$ (Y
under the treatment a = 0) be the outcome variable that would have been observed if the patient had not received the
treatment.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;When estimating the causal effect on the &lt;strong&gt;population&lt;/strong&gt;, it&amp;rsquo;s usually to consider the average treatment effect (ATE),
$ATE = E[Y^{a=1}] - E[Y^{a=0}]$, denoting the average causal effect of the treatment on the outcome.&lt;/p&gt;
&lt;h2 id=&#34;causal-effect-estimation&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#causal-effect-estimation&#34;&gt;
    &lt;/a&gt;
    Causal Effect Estimation
&lt;/div&gt;
&lt;/h2&gt;
&lt;p&gt;With the causal formulation and the average treatment effect defined, the next step is to estimate the causal effect
from the observed data. Multiple methods have been developed for this purpose, each relying on different assumptions
and is suitable for different scenarios. Some of the most common methods include: &lt;em&gt;randomized controlled trials (A/B
testing)&lt;/em&gt;, &lt;em&gt;confounder adjustments methods&lt;/em&gt;, &lt;em&gt;instrumental variables&lt;/em&gt;, and &lt;em&gt;difference-in-differences&lt;/em&gt; etc.&lt;/p&gt;
&lt;h3 id=&#34;randomized-controlled-trials-ab-testing&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#randomized-controlled-trials-ab-testing&#34;&gt;
    &lt;/a&gt;
    Randomized Controlled Trials (A/B Testing)
&lt;/div&gt;
&lt;/h3&gt;
&lt;p&gt;The most common approach to estimate the causal effect is to run an experiment, usually in the following general steps.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Objective: Define the research question and the hypothesis (usually built with treatment metrics) to be tested.&lt;/li&gt;
&lt;li&gt;Design: Randomly assign the subjects into two groups, the treatment group (A) and the control group (B). The
treatment group receives the treatment, while the control group does not.&lt;/li&gt;
&lt;li&gt;Randomization: Randomly assign the subjects to the treatment and control groups to ensure the groups are comparable.&lt;/li&gt;
&lt;li&gt;Run test: Implement the A/B test and let it run for a sufficient period to gather an adequate amount of data&lt;/li&gt;
&lt;li&gt;Analysis: Analyze the data and calculate the treatment effect.&lt;/li&gt;
&lt;li&gt;Decisions: Make decisions based on the test results.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Randomized controlled trials are considered the gold standard for causal inference because they can eliminate the
confounding bias by randomizing the treatment assignment. However, they are not always feasible due to ethical,
practical, or financial reasons. Therefore, other methods are developed to estimate the causal effect from observational
data.&lt;/p&gt;
&lt;h3 id=&#34;causal-inference---confounder-adjustments-methods&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#causal-inference---confounder-adjustments-methods&#34;&gt;
    &lt;/a&gt;
    Causal Inference - Confounder Adjustments Methods
&lt;/div&gt;
&lt;/h3&gt;
&lt;p&gt;Before diving into the confounder adjustments methods, let&amp;rsquo;s first clarify the confounding bias. Consider the following
example:
&lt;img src=&#34;https://bingzw.github.io/causality/confounder_selection_bias.png&#34; alt=&#34;confounder_selection_bias&#34;&gt;
A study is conducted to investigate the effect of a new drug on the health outcome of patients. The study
finds that patients who received the new drug have a higher recovery rate than those who did not. However, the study
also finds that the patients who received the new drug are younger and healthier than those who did not. Therefore, the
observed effect of the new drug on the health outcome may be &lt;strong&gt;confounded&lt;/strong&gt; by the age and health status of the patients.
To estimate the causal effect of the new drug on the health outcome, we need to &lt;em&gt;adjust&lt;/em&gt; for the confounding factors,
such as age and health status.&lt;/p&gt;
&lt;h4 id=&#34;key-assumptions&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#key-assumptions&#34;&gt;
    &lt;/a&gt;
    Key Assumptions
&lt;/div&gt;
&lt;/h4&gt;
&lt;p&gt;All the confounder adjustments methods rely on the following key assumptions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Exchangeability&lt;/strong&gt;: the treatment assignment is independent of the potential outcomes given the covariates.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Positivity&lt;/strong&gt;: the probability of receiving the treatment is positive for all levels of the covariates.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Consistency&lt;/strong&gt;: the individual&amp;rsquo;s potential outcome is the same as the observed outcome when the treatment is received.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;inverse-probability-weighting&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#inverse-probability-weighting&#34;&gt;
    &lt;/a&gt;
    Inverse Probability Weighting
&lt;/div&gt;
&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Key Idea: Assigning weights to observations in order to create a pseudo-population that approximates the population
that would have been obtained through random assignment in a randomized control trial (RCT).&lt;/li&gt;
&lt;li&gt;Steps:
&lt;ol&gt;
&lt;li&gt;Estimate the propensity score, $pps(x) = P(A = 1 | X = x)$, the probability of receiving the treatment given the
covariates.&lt;/li&gt;
&lt;li&gt;Calculate the inverse probability weights, $w_i = \frac{P(A_i)}{pps(x_i)}$.&lt;/li&gt;
&lt;li&gt;Fit a marginal structure model $E[Y^a] = \beta_0 + \beta_1 a$ with the inverse probability weights $w_i$.&lt;/li&gt;
&lt;li&gt;Estimate the average treatment effect, $ATE = \hat{\beta_1}$.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;standardization&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#standardization&#34;&gt;
    &lt;/a&gt;
    Standardization
&lt;/div&gt;
&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Key Idea: Standardize the outcome under different treatment conditions to estimate the average treatment effect.&lt;/li&gt;
&lt;li&gt;Steps:
&lt;ol&gt;
&lt;li&gt;Fit the outcome model with treatment and covariates, $P[Y^a | X=x] = P(Y | A=a, X=x)$. For example, the linear model
representation is $Y^A = \beta_0 + \beta_1 A + \beta_2 X$.&lt;/li&gt;
&lt;li&gt;Estimate the expectation of the outcome under different treatment conditions:
$E[Y^a] = \int_x P(Y|A=a, x)*f_X(x)dx$.&lt;/li&gt;
&lt;li&gt;Calculate the average treatment effect, $ATE = E[Y^{a=1}] - E[Y^{a=0}]$.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;stratification&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#stratification&#34;&gt;
    &lt;/a&gt;
    Stratification
&lt;/div&gt;
&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Key Idea: Stratify the data into different strata based on the covariates and estimate the average treatment effect.&lt;/li&gt;
&lt;li&gt;Steps:
&lt;ol&gt;
&lt;li&gt;Estimate the propensity score, $pps(x) = P(A = 1 | X = x)$, the probability of receiving the treatment given the
covariates.&lt;/li&gt;
&lt;li&gt;Fit the outcome model with treatment and propensity score as the covariates,
$P[Y^a | X=x] = P(Y | A=a, pps(x))$. A simple linear representation is $Y^A = \beta_0 + \beta_1 A + \beta_2 * pps(X)$.&lt;/li&gt;
&lt;li&gt;Estimate the expectation of the outcome under different treatment conditions:
$E[Y^a] = \int_x P(Y|A=a, pps(x))*f_X(x)dx$&lt;/li&gt;
&lt;li&gt;Calculate the average treatment effect, $ATE = E[Y^{a=1}] - E[Y^{a=0}]$.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;propensity-score-matching&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#propensity-score-matching&#34;&gt;
    &lt;/a&gt;
    Propensity Score Matching
&lt;/div&gt;
&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Key Idea: Match the treated and control units based on the propensity score to estimate the average treatment effect.&lt;/li&gt;
&lt;li&gt;Steps:
&lt;ol&gt;
&lt;li&gt;Estimate the propensity score, $pps(x) = P(A = 1 | X = x)$, the probability of receiving the treatment given the
covariates.&lt;/li&gt;
&lt;li&gt;Match the treated and control units based on the propensity score. (Nearest Neighbour, Kernel Matching, etc)&lt;/li&gt;
&lt;li&gt;Estimate the average treatment effect, $ATE = E[Y^{a=1}] - E[Y^{a=0}]$.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;causal-inference---instrumental-variables&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#causal-inference---instrumental-variables&#34;&gt;
    &lt;/a&gt;
    Causal Inference - Instrumental Variables
&lt;/div&gt;
&lt;/h3&gt;
&lt;h3 id=&#34;difference-in-differences&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#difference-in-differences&#34;&gt;
    &lt;/a&gt;
    Difference-In-Differences
&lt;/div&gt;
&lt;/h3&gt;
&lt;h2 id=&#34;root-cause-optimization&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#root-cause-optimization&#34;&gt;
    &lt;/a&gt;
    Root Cause Optimization
&lt;/div&gt;
&lt;/h2&gt;
&lt;h2 id=&#34;appendix&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#appendix&#34;&gt;
    &lt;/a&gt;
    Appendix
&lt;/div&gt;
&lt;/h2&gt;
&lt;h3 id=&#34;causal-hierarchy-observation-intervention-counterfactual&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#causal-hierarchy-observation-intervention-counterfactual&#34;&gt;
    &lt;/a&gt;
    Causal Hierarchy: Observation, Intervention, Counterfactual
&lt;/div&gt;
&lt;/h3&gt;
&lt;h4 id=&#34;causation-vs-association&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#causation-vs-association&#34;&gt;
    &lt;/a&gt;
    Causation vs Association
&lt;/div&gt;
&lt;/h4&gt;
&lt;h4 id=&#34;intervention-vs-counterfactual&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#intervention-vs-counterfactual&#34;&gt;
    &lt;/a&gt;
    Intervention vs Counterfactual
&lt;/div&gt;
&lt;/h4&gt;
&lt;h3 id=&#34;do-calculus&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#do-calculus&#34;&gt;
    &lt;/a&gt;
    Do Calculus
&lt;/div&gt;
&lt;/h3&gt;
&lt;h2 id=&#34;reference&#34; &gt;
&lt;div&gt;
    &lt;a href=&#34;#reference&#34;&gt;
    &lt;/a&gt;
    Reference
&lt;/div&gt;
&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=Od6oAz1Op2k&#34;&gt;https://www.youtube.com/watch?v=Od6oAz1Op2k&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>
